---
layout: post
title:  "Задачка на парсинг Javascript"
date:   2025-04-01 0:00:00
categories: [javascript, code]
---

Хоть я и ненавижу задачки на тему "поработайте компилятором языка программирования X", эта понравилась.

Предлагается распарсить небольшой фрагмент кода и попробовать угадать, что будет выведено в консоль, если выполнить этот код в браузере:

```js
x
= 1
x
--> 0
```

Результат, на самом деле, неожиданный.

<details>
  <summary>Показать ответ</summary>
1
</details>
<p><br><br><br></p>

В чём же тут дело, давайте разбираться.

Приведённый фрагмент эквивалентен следующему фрагменту:

```js
x = 1
x; // 0
```

Строка, начинающаяся с символов `-->` трактуется в JS как комментарий.

Но почему? А приветы следует направлять в начало девяностых, когда в `Netscape Navigator 2` появился `Javascript`, и фрагменты кода следовало писать так:

```js
<script>
<!--
alert("Hello!")
-->
</script>
```

Делалось это для других браузеров, которые ничего не знали про тег `script`, и, чтобы они не вываливали код на экран, внутренности полагалось завернуть в обычные `html`-комментарии `<!-- ... -->`, а в парсере `JS`, в свою очередь, был применён хак, чтобы строки `<!--` и `-->` не вызывали ошибку скрипта и игнорировались.

К сегодняшнему дню почти не осталось бразуеров, которые не знают про тег `script`, но старые последовательности продолжают поддерживаться, так как в интернете полно страниц из девяностых, которые с тех пор не обновлялись. Выдавать `JS`-ошибку на таких страницах не хотелось бы. Вот и приходится до сих пор поддерживать такой необычный формат комментариев.

[MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Deprecated_and_obsolete_features#html_comments)
